{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "$id": "felles/1.0/Kvittering.schema.json",
  "description": "Schema som beskriver kvitteringer som skal utveksles på tvers av virksomhetene",
  "additionalProperties": true,
  "properties": {
    "meldingsId": {
      "type": "string",
      "description": "Meldingsid for selve kvitteringen"
    },
    "meldingsIdRef": {
      "type": "string",
      "description": "Meldingsid for meldingen vi kvitterer"
    },
    "status": {
      "$ref": "#/definitions/StatusType",
      "description": "Status for meldingen vi kvitterer"
    },
    "beskrivelse": {
      "type": "string",
      "description": "Tekstlig beskrivelse. Brukes i forbindelse med statusene FEILET_AVSENDER og FEILET_MOTTAKER"
    },
    "saksRef": {
		"type": "string",
		"description": "Saksnummeret fra Lovisa. Vil kun være med fra domstolen dersom status er MOTTATT (altså kun etter at saken er opprettet"
    }
  },
  "definitions": {
    "StatusType": {
      "description": "Liste over mulige statuser",      
      "enum": [
        "UNDER_MOTTAK",
        "MOTTATT",
        "FEILET_AVSENDER_TEKNINSK",
        "FEILET_AVSENDER_MANGLER",
        "FEILET_MOTTAKER"
      ],
      "type": "string",
      "options": [{
            "value": "UNDER_MOTTAK",
            "description": "Indikerer at meldingen er mottatt, men ikke ferdig prosessert inn i saksbehandlingssystem. Det kan fremdeles oppstå feil som gjør at avsender eller mottaker må starte feilsøking."
        }, 
        {
          "value": "MOTTATT",
            "description": "Indikerer at alt er ok. Ingen nye kvitteringer forventes. Avsender kan fjerne vedlegg fra filtjeneste når MOTTATT er mottatt."
        },
        {
          "value": "FEILET_AVSENDER_TEKNISK",
            "description": "Indikerer at det er en teknisk feil hos avsender. F.eks. feil format, vedlegg som ikke fins på STFP selv om det fins referanse i melding etc. Feltet 'beskrivelse' skal fylles ut med en feilmelding/exception. Det er forventet av _avsender_ å iverksette nødvendige tiltak for å sende melding på nytt. En slik status skal aldri sendes etter at en MOTTATT melding er sendt. Ingen nye kvitteringer forventes.",
        },
        {
          "value": "FEILET_AVSENDER_MANGLER",
          "description": "Indikerer at det er mangler i forsendelsen som er avdekket av saksbehandler. F.eks. at forventet påtegning er avglemt. Feltet 'beskrivelse' skal fylles ut med en feilmelding skrevet av bruker. Meldingen forkastes og det er forventet av _avsender_ skal sende hele meldingen på nytt. En slik status skal aldri sendes etter at en MOTTATT melding er sendt. Ingen nye kvitteringer forventes."
        },
        {
          "value": "FEILET_MOTTAKER",
          "description": "Indikerer at det er noe feil hos mottaker. F.eks. bug eller system nede. Det er forventet at _mottaker_ undersøker. En slik status skal aldri sendes etter at en MOTTATT melding er sendt. Det forventes at det skal komme en MOTTATT eller FEILET_AVSENDER kvittering i etterkant dersom feilen utbedres på mottakersiden. Men statusen kan bli stående dersom problemet løses ved at meldingen sendes på nytt"
        }
      ]
      }
    }, 
    "required": [
				"meldingsId",
				"meldingsIdRef",
				"status"
			],
  "type": "object"
}